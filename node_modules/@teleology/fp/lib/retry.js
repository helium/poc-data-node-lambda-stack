"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.retrySync = exports.retry = void 0;

/* eslint-disable no-await-in-loop */
const DEFAULT_ROLLOFF = async () => {};

const retry = (fn, max = 3, rolloff = DEFAULT_ROLLOFF) => async (...args) => {
  for (let i = 0; i < max; i += 1) {
    try {
      return await fn(...args);
    } catch (e) {
      if (i + 1 >= max) {
        throw e;
      }

      await rolloff(i + 1);
    }
  }
};

exports.retry = retry;

const retrySync = (fn, max = 3) => (...args) => {
  for (let i = max - 1; i > -1; i -= 1) {
    try {
      return fn(...args);
    } catch (e) {
      if (!i) {
        throw e;
      }
    }
  }
};

exports.retrySync = retrySync;